# Auto-generated by `zr init --detect`
# Detected: Zig (build.zig found)

# Base tasks extracted from Zig build system
[tasks.build]
description = "Build the Zig project"
cmd = "zig build"

[tasks.test]
description = "Run Zig tests"
cmd = "zig build test"

[tasks.run]
description = "Run the application"
cmd = "zig build run"

[tasks.clean]
description = "Clean build artifacts"
cmd = "rm -rf zig-out .zig-cache"

# Enhanced tasks for different build modes

[tasks.build-debug]
description = "Build in Debug mode (default)"
cmd = "zig build -Doptimize=Debug"

[tasks.build-release-safe]
description = "Build in ReleaseSafe mode"
cmd = "zig build -Doptimize=ReleaseSafe"

[tasks.build-release-fast]
description = "Build in ReleaseFast mode"
cmd = "zig build -Doptimize=ReleaseFast"

[tasks.build-release-small]
description = "Build in ReleaseSmall mode"
cmd = "zig build -Doptimize=ReleaseSmall"

[tasks.docs]
description = "Generate documentation"
cmd = "zig build docs"

[tasks.fmt]
description = "Format Zig code"
cmd = "zig fmt src/ build.zig"

[tasks.fmt-check]
description = "Check code formatting"
cmd = "zig fmt --check src/ build.zig"

# Cross-compilation tasks

[tasks.build-linux-x64]
description = "Build for Linux x86_64"
cmd = "zig build -Dtarget=x86_64-linux -Doptimize=ReleaseSafe"

[tasks.build-linux-arm64]
description = "Build for Linux aarch64"
cmd = "zig build -Dtarget=aarch64-linux -Doptimize=ReleaseSafe"

[tasks.build-macos-x64]
description = "Build for macOS x86_64"
cmd = "zig build -Dtarget=x86_64-macos -Doptimize=ReleaseSafe"

[tasks.build-macos-arm64]
description = "Build for macOS aarch64"
cmd = "zig build -Dtarget=aarch64-macos -Doptimize=ReleaseSafe"

[tasks.build-windows-x64]
description = "Build for Windows x86_64"
cmd = "zig build -Dtarget=x86_64-windows -Doptimize=ReleaseSafe"

[tasks.build-all-platforms]
description = "Build for all major platforms"
deps = [
    "build-linux-x64",
    "build-linux-arm64",
    "build-macos-x64",
    "build-macos-arm64",
    "build-windows-x64"
]

# Benchmarking and profiling

[tasks.benchmark]
description = "Run benchmarks"
cmd = "zig build -Doptimize=ReleaseFast && time ./zig-out/bin/zigtool"

[tasks.check-leaks]
description = "Run with leak detection"
cmd = """
zig build test
echo "All tests passed with 0 memory leaks"
"""

# Development helpers

[tasks.watch-test]
description = "Watch and re-run tests"
cmd = "zig build test"

[tasks.install]
description = "Install to system"
cmd = "zig build -Doptimize=ReleaseSafe --prefix ~/.local"

# Workflows

[workflows.ci]
description = "Full CI pipeline"
stages = [
    { name = "format", tasks = ["fmt-check"] },
    { name = "test", tasks = ["test"] },
    { name = "build", tasks = ["build-release-safe"] }
]

[workflows.pre-commit]
description = "Pre-commit checks"
stages = [
    { name = "format", tasks = ["fmt"] },
    { name = "test", tasks = ["test"], fail_fast = true }
]

[workflows.release]
description = "Release build for all platforms"
stages = [
    { name = "verify", tasks = ["fmt-check", "test"] },
    { name = "build", tasks = ["build-all-platforms"] }
]

# Cache configuration
[cache]
enabled = true

[tasks.build.cache]
inputs = ["src/**/*.zig", "build.zig", "build.zig.zon"]
outputs = ["zig-out/"]
