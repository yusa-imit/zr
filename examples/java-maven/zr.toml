# Auto-generated by `zr init --detect` for Maven project
# Enhanced with custom workflows and profiles

[global]
shell = "bash"

# Basic Maven tasks (auto-detected)

[tasks.build]
description = "Build project with Maven"
cmd = "mvn clean package"
inputs = ["src/**/*.java", "pom.xml"]
outputs = ["target/"]

[tasks.test]
description = "Run tests with Maven"
cmd = "mvn test"
inputs = ["src/**/*.java", "pom.xml"]

[tasks.clean]
description = "Clean build artifacts"
cmd = "mvn clean"

[tasks.install]
description = "Install to local Maven repository"
cmd = "mvn install"
deps = ["test"]

[tasks.verify]
description = "Run integration tests and verification"
cmd = "mvn verify"

[tasks.run]
description = "Execute main class"
cmd = "mvn exec:java"
deps = ["build"]

# Enhanced tasks

[tasks.coverage]
description = "Generate test coverage report"
cmd = "mvn jacoco:report"
deps = ["test"]
outputs = ["target/site/jacoco/"]

[tasks.coverage-check]
description = "Verify test coverage meets threshold"
cmd = "mvn jacoco:check"
deps = ["coverage"]

[tasks.package-prod]
description = "Build production package"
cmd = "mvn clean package -DskipTests -Pprod"

[tasks.dependency-tree]
description = "Display dependency tree"
cmd = "mvn dependency:tree"
cache = false

# CI/CD workflow

[workflows.ci]
description = "Full CI pipeline"
stages = [
    { tasks = ["clean"] },
    { tasks = ["test"] },
    { tasks = ["coverage-check"] },
    { tasks = ["build"] }
]

# Profiles for different environments

[profile.production]
[profile.production.env]
MAVEN_OPTS = "-Xmx2048m"

[profile.development]
[profile.development.env]
MAVEN_OPTS = "-Xmx512m"
