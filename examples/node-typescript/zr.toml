# Auto-generated by `zr init --detect`
# Detected: Node.js (package.json found)

# Base tasks extracted from package.json scripts
[tasks.build]
description = "Compile TypeScript to JavaScript"
cmd = "npm run build"

[tasks.dev]
description = "Run in development mode with watch"
cmd = "npm run dev"

[tasks.start]
description = "Start the compiled application"
cmd = "npm run start"
deps = ["build"]

[tasks.test]
description = "Run unit tests"
cmd = "npm run test"

[tasks.test-watch]
description = "Run tests in watch mode"
cmd = "npm run test:watch"

[tasks.test-coverage]
description = "Run tests with coverage report"
cmd = "npm run test:coverage"

[tasks.lint]
description = "Lint TypeScript code"
cmd = "npm run lint"

[tasks.lint-fix]
description = "Lint and auto-fix issues"
cmd = "npm run lint:fix"

[tasks.format]
description = "Format code with Prettier"
cmd = "npm run format"

[tasks.format-check]
description = "Check code formatting"
cmd = "npm run format:check"

[tasks.typecheck]
description = "Type-check without emitting"
cmd = "npm run typecheck"

# Enhanced tasks for development workflow

[tasks.install]
description = "Install dependencies"
cmd = "npm install"

[tasks.clean]
description = "Remove build artifacts"
cmd = "rm -rf dist coverage"

[tasks.clean-all]
description = "Remove build artifacts and node_modules"
cmd = "rm -rf dist coverage node_modules"

[tasks.rebuild]
description = "Clean and rebuild"
deps = ["clean", "install", "build"]

[tasks.check-types]
description = "Comprehensive type checking"
cmd = "tsc --noEmit --pretty"

[tasks.bundle]
description = "Create production bundle"
cmd = """
npm run build
npm pack
echo "Bundle created: $(ls -1 *.tgz | tail -1)"
"""
deps = ["test", "lint"]

# Workflows for common operations

[workflows.ci]
description = "Full CI pipeline"
stages = [
    { name = "setup", tasks = ["install"] },
    { name = "quality", tasks = ["format-check", "lint", "typecheck"], fail_fast = true },
    { name = "test", tasks = ["test-coverage"] },
    { name = "build", tasks = ["build"] }
]

[workflows.pre-commit]
description = "Pre-commit checks (fast)"
stages = [
    { name = "format", tasks = ["format"] },
    { name = "check", tasks = ["lint", "typecheck", "test"], fail_fast = true }
]

[workflows.release]
description = "Release workflow"
stages = [
    { name = "verify", tasks = ["clean", "install", "test-coverage", "lint", "typecheck"] },
    { name = "build", tasks = ["bundle"] }
]

# Cache configuration for faster builds
[cache]
enabled = true

[tasks.build.cache]
inputs = ["src/**/*.ts", "tsconfig.json"]
outputs = ["dist/"]

[tasks.test.cache]
inputs = ["src/**/*.ts", "vitest.config.ts"]
